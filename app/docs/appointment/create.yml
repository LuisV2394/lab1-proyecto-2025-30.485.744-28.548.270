tags:
  - Appointments
summary: Create a new appointment request
description: >
  Creates a new appointment for a person within an open schedule block.
  Validates availability, block state, capacity, and time overlap.
operationId: createAppointment

parameters:
  - name: body
    in: body
    required: true
    schema:
      type: object
      required:
        - start
        - professionalId
        - personId
        - unitId
        - motivo
        - canal
      properties:
        start:
          type: string
          format: date-time
          example: "2025-01-15T14:00:00"
        professionalId:
          type: integer
          example: 3
        personId:
          type: integer
          example: 12
        unitId:
          type: integer
          example: 5
        motivo:
          type: string
          example: "Consulta general"
        canal:
          type: string
          enum:
            - presential
            - phone
            - video
          example: presential
        observations:
          type: string
          example: "Paciente solicita ser atendido temprano"
        duration_minutes:
          type: integer
          example: 60

responses:
  201:
    description: Appointment created successfully
    schema:
      type: object
      properties:
        id:
          type: integer
          example: 44
        message:
          type: string
          example: "Cita creada con Ã©xito"

  400:
    description: Validation error (missing fields or invalid data)
    schema:
      type: object
      properties:
        error:
          type: string
          example: "Faltan campos obligatorios"

  404:
    description: Related resource not found (professional, unit or person)
    schema:
      type: object
      properties:
        error:
          type: string
          example: "El profesional no existe"

  409:
    description: Block capacity exceeded
    schema:
      type: object
      properties:
        error:
          type: string
          example: "No hay cupo disponible en este bloque"

  500:
    description: Server error
    schema:
      type: object
      properties:
        error:
          type: string
          example: "Error interno del servidor"